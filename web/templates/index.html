{% extends "base.html" %}

{% block title %}æˆ¦ç•¥ä¸€è¦§ - Stock Strategy Analyzer{% endblock %}

{% block content %}
<section class="hero">
    <h1>Stock Strategy Analyzer</h1>
    <p class="hero-sub">ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœã«åŸºã¥ãéŠ˜æŸ„ãƒ»æˆ¦ç•¥ã®é©åˆåº¦åˆ†æ</p>

    {% if metadata %}
    <div class="stats-bar">
        <div class="stat">
            <span class="stat-value">{{ metadata.processed_stocks or 0 }}</span>
            <span class="stat-label">å‡¦ç†æ¸ˆã¿éŠ˜æŸ„</span>
        </div>
        <div class="stat">
            <span class="stat-value">{{ metadata.strategies|length }}</span>
            <span class="stat-label">æŠ•è³‡æˆ¦ç•¥</span>
        </div>
        <div class="stat">
            <span class="stat-value">{{ metadata.last_updated[:10] if metadata.last_updated else '-' }}</span>
            <span class="stat-label">æœ€çµ‚æ›´æ–°</span>
        </div>
    </div>
    {% endif %}

    <div class="nav-links">
        <a href="/" class="nav-link active">ğŸ“Š é©åˆåº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a>
        <a href="/approaching" class="nav-link">ğŸ¯ ã‚·ã‚°ãƒŠãƒ«æ¥è¿‘ä¸­</a>
    </div>
</section>

<style>
    .nav-links {
        margin-top: 1.5rem;
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    .nav-link {
        padding: 0.5rem 1rem;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        text-decoration: none;
        border-radius: 20px;
        transition: all 0.2s;
    }

    .nav-link:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .nav-link.active {
        background: rgba(255, 255, 255, 0.25);
        font-weight: bold;
    }
</style>

<section class="criteria-section">
    <details class="criteria-details">
        <summary class="criteria-summary">ğŸ“‹ é©åˆåº¦ã®è©•ä¾¡åŸºæº–</summary>
        <div class="criteria-content">
            <p class="criteria-intro">é©åˆåº¦ã¯ä»¥ä¸‹ã®æŒ‡æ¨™ã‚’ç·åˆçš„ã«è©•ä¾¡ã—ã¦ç®—å‡ºã•ã‚Œã¾ã™ï¼ˆ40%ä»¥ä¸Šã®ã¿ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã«è¡¨ç¤ºï¼‰</p>
            <div class="criteria-grid">
                <div class="criteria-item">
                    <h4>ğŸ“ˆ ãƒªã‚¿ãƒ¼ãƒ³ï¼ˆ40%ï¼‰</h4>
                    <ul>
                        <li><span class="ok">OK</span> +20%ä»¥ä¸Š: é«˜ãƒªã‚¿ãƒ¼ãƒ³</li>
                        <li><span class="ok">OK</span> +10%ã€œ20%: ä¸­ãƒªã‚¿ãƒ¼ãƒ³</li>
                        <li><span class="mid">ä¸­</span> 0%ã€œ10%: å°ãƒªã‚¿ãƒ¼ãƒ³</li>
                        <li><span class="ng">NG</span> ãƒã‚¤ãƒŠã‚¹: æå¤±</li>
                    </ul>
                </div>
                <div class="criteria-item">
                    <h4>ğŸ¯ å‹ç‡ï¼ˆ30%ï¼‰</h4>
                    <ul>
                        <li><span class="ok">OK</span> 60%ä»¥ä¸Š: é«˜å‹ç‡</li>
                        <li><span class="mid">ä¸­</span> 40%ã€œ60%: ä¸­å‹ç‡</li>
                        <li><span class="ng">NG</span> 40%æœªæº€: ä½å‹ç‡</li>
                    </ul>
                </div>
                <div class="criteria-item">
                    <h4>ğŸ”¢ å–å¼•å›æ•°ï¼ˆ30%ï¼‰</h4>
                    <ul>
                        <li><span class="ok">OK</span> 10å›ä»¥ä¸Š: ååˆ†ãªæ©Ÿä¼š</li>
                        <li><span class="mid">ä¸­</span> 5ã€œ9å›: æ©Ÿä¼šã‚ã‚Š</li>
                        <li><span class="ng">NG</span> 5å›æœªæº€: æ©Ÿä¼šå°‘</li>
                    </ul>
                </div>
                <div class="criteria-item">
                    <h4>ğŸ“‰ æœ€å¤§ä¸‹è½ç‡</h4>
                    <ul>
                        <li><span class="ok">OK</span> 20%æœªæº€: ä½ãƒªã‚¹ã‚¯</li>
                        <li><span class="mid">ä¸­</span> 20%ã€œ40%: ä¸­ãƒªã‚¹ã‚¯</li>
                        <li><span class="ng">NG</span> 40%ä»¥ä¸Š: é«˜ãƒªã‚¹ã‚¯</li>
                    </ul>
                    <p class="note">â€»æœ€é«˜å€¤ã‹ã‚‰ã®æœ€å¤§ä¸‹è½å¹…</p>
                </div>
            </div>
        </div>
    </details>
</section>

<section class="strategies-section">
    <h2>æˆ¦ç•¥åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
    <div class="strategy-grid">
        {% for strategy in strategies %}
        <a href="{{ url_for('strategy_ranking', name=strategy.name) }}" class="strategy-card">
            <h3 class="strategy-name">{{ strategy.name }}</h3>

            {% if strategy.top3 %}
            <div class="top3-preview">
                {% for item in strategy.top3 %}
                <div class="preview-item">
                    <span class="rank">#{{ item.rank }}</span>
                    <span class="code">{{ item.code }}</span>
                    <span class="name">{{ item.name }}</span>
                    <span class="score">{{ "%.1f"|format(item.score) }}%</span>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <span class="card-arrow">â†’</span>
        </a>
        {% endfor %}
    </div>
</section>
{% endblock %}